var app=angular.module("app",[]);app.controller("HomeController",["$scope","Tube","Weather","NationalRail","Geo",function(b,a,e,g,d){b.loaded=true;b.data={weather:null,tube:null,rail:null};b.geoLocationFailure=false;b.destinationRailFailure=false;b.expanded={trains:false,weather:false};a.get().then(function(h){b.data.tube=h.data.data});d.get().then(function f(h){g.get(h).then(function(i){b.data.rail=i.data.data})},function c(){b.geoLocationFailure=true;g.get().then(function(h){b.data.rail=h.data.data})});d.get().then(function f(h){e.get(h).then(function(i){b.data.weather=i.data.data})},function c(){b.geoLocationFailure=true;e.get().then(function(h){b.data.weather=h.data.data})})}]);app.factory("Tube",["$http",function(a){return{get:function(){return a.get("/api/tube")}}}]);app.factory("Geo",["$q",function(a){navigator.geolocation.getCurrentPosition(function(b){return{lat:b.coords.latitude,lon:b.coords.longitude}});return{get:function(){var b=a.defer();navigator.geolocation.getCurrentPosition(function(d){b.resolve({lat:d.coords.latitude,lon:d.coords.longitude})},function c(d){b.reject(d)},{timeout:10000});return b.promise}}}]);app.factory("Weather",["$http",function(a){return{get:function(b){var c="";if(b){c=b.lat+","+b.lon}return a.get("/api/weather/"+c)}}}]);app.factory("NationalRail",["$http",function(a){return{get:function(b){var c="";if(b){c="/"+b.lat+","+b.lon}return a.get("/api/rail/LEW/LBG"+c)}}}]);app.filter("trustHtml",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]);app.filter("severityToText",["Tube",function(a){return function(b){return a.statusToText(b)}}]);